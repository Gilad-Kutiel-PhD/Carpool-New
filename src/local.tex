The local search algorithm maintains a feasible matching throughout its execution
and operates in 
iterative manner where in each iteration it tries to find a better solution by
replacing a subset of the edges in the current solution with 
another (larger) subset of edges not in the solution.
The local search algorithm halts when no improvement can be done.
The algorithm is described in Algorithm~\ref{alg:local}. 

\begin{algorithm}
\SetKw{True}{true}
\SetKw{False}{false}
\KwIn{$G = (V, A)$, $c : V \rightarrow \N$, $k$}
\KwOut{$M$}
$M \leftarrow \emptyset$								\\
\Repeat{done}{
\label{line:outerloop}
 	$done \leftarrow{}$ \True							\\
 	\For{$M' \in M : |M'| \leq k$}{
 		\For{$A' \in A \setminus M : |A'| = |M'| + 1$}{
			\If{$M \setminus M' \cup A'$ is feasible}{
				$M \leftarrow{} M \setminus M' \cup A'$	\\
				$done \leftarrow{}$ \False				\\
			}
		}
 	}
}
\Return{$M$}

\caption{
\label{alg:local}
Local Search}
\end{algorithm}


We claim that the local search algorithm halts in polynomial time.
Observed that in every iteration the algorithm either improves the value of the solution
by one or otherwise it terminates. 
Thus, after a maximum of $n$ iterations the algorithm stops.
In every iteration we examine all the subsets of edges of a fixed size and test for feasibility,
both these operations can be done in polynomial time - $O(n^{Ck + 1})$. 

To analyze the approximation ratio achieved by the local search algorithm consider an 
arbitrary but fixed optimal matching $M^*$.
Given the solution outputted by the local search algorithm, 
$M$, 
we build the \emph{star graph} of the two solutions
in which each node represents a star from the optimal solution 
and edges exits between two nodes if
there is a star in $S(M)$ that intersect the two
corresponding stars of the optimal solution, 
formally $G^{M^*}_M = (S, E)$ where $\{v_i : S^*_i \in S(M^*) \}$ 
and 
$E = \{(v_i, v_j) : 
\exists S \in M,
S \cap S^*_i \neq \emptyset \land S \cap S^*_j \neq \emptyset,
\}$.
Figure~\ref{fig:conflict} depicts a star graph.

\begin{figure}[ht]
\centering
\subfloat[]{
\label{subfloat:graph}
\input{fig-sub-graph}
}
\subfloat[]{
\label{subfloat:conflict}
\input{fig-sub-conflict}
}
\caption[]{
\label{fig:conflict}
\subref{subfloat:input} 
An optimal matching depicted by the dashed red edges,
and another solution depicted by the solid green edges.  
\subref{subfloat:output}
The conflict graph, the upper left vertex corresponds 
to the star that contains the vertices a,b,c.
The numbers inside the vertices corresponds to $d_i$.   
}
\end{figure}  

For a group of vertices, $U$, denote by $w^*(U)$ the sum of the degrees 
induced by the underlying graph of the optimal solution on this set, i.e.
$\sum_{u \in U} \dinout[M^*](u)$, 
and let $w(S)$ be the sum of the degrees 
induced by the underlying graph of the local search solution on this set, i.e.
$\sum_{u \in U} \dinout(u)$.

\begin{lemma}
\label{lemma:r}
If $k \geq \text{TODO}$ then in any connected induced graph of $G^{M^*}_M$, 
$G'= G^{M^*}_M[U]$, 
$
\frac{w(U)}{w^*(U)} 
\geq \frac{1}{2} + \frac{1}{2C} - \frac{1}{2C|U|}
$.
\end{lemma}

\begin{proof}
Consider the solution obtained from the $M$ by removing all the edges from $M$
that intersect the induced subgraph, and adding all the edges from $M^*$ that
intersect the induced subgraph.
It is easy to verify that this is a feasible solution.
We now bound from below the difference in the value of the solution.
The value decrease due to the removal of the edges by at most $w(U) - |U| + 1$,
and increase by exactly $\frac{w^*(U)}{2} \leq C |U|$.
We know that this difference can not be positive, or else, the local search
algorithm would not have been terminated.
Thus 
$\frac{w^*(U)}{2} \leq w(U) - |U| + 1$ 
and so
$
\frac{w(U)}{w^*(U)} 
\geq 
\frac{1}{2} + \frac{|U|}{w^*(U))} - \frac{1}{w^*(U))}  
\geq
\frac{1}{2} + \frac{1}{2C} - \frac{1}{2C|U|}
$
\end{proof}


\begin{lemma}
\label{lemma:dec}
Given a parameter $k$, a bounded degree connected graph $G$, with a maximum
degree $d$ can be decomposed into connected components of size at least $k$, and at most
$d(k-1) + 1$.
\end{lemma}

\begin{proof}
We give a constructive proof.
Start constructing a connected component by adding adjacent vertices
one by one to the component and removing them from the graph.
If at some point, removing a vertex disconnect the graph, add all the small
components (of size less than $k$) to the constructed component and decompose
the large components (of size at least $k$) recursively.
Note that removing a vertex can break the graph to at most $d - 1$ additional
components.
\end{proof}

\begin{theorem}
The local search is ($\frac{1}{2} + \frac{1}{2c} - \varepsilon$)-approximation
algorithm.
\end{theorem}

\begin{proof}
Combine lemma~\ref{lemma:dec}, and lemma~\ref{lemma:r}, 
and observe that the maximum degree in $G^{M^*}_M$ is $(C + 1)^C$ to
get the desire result.
\end{proof}

\todo{show that the analysis is tight}


